# -*- coding: utf-8 -*-

import numpy as np
from rdkit import Chem
from rdkit.Chem import Descriptors
from collections import defaultdict
from rdkit.Chem.rdchem import BondType
import pickle
import torch
# from SEC_pre import pre_ss
from graph_features import atom_features
from rdkit.Chem import AllChem, rdMolDescriptors
# from gensim.models import word2vec
from collections import defaultdict
# from mol2vec.features import mol2alt_sentence, mol2sentence, MolSentence, DfVec, sentences2vec

from prints import getprints
import pandas as pd

#model = word2vec.Word2Vec.load('model_300dim.pkl')
# rdkit GetBondType() result -> int
BONDTYPE_TO_INT = defaultdict(
    lambda: 0,
    {
        BondType.SINGLE: 0,
        BondType.DOUBLE: 1,
        BondType.TRIPLE: 2,
        BondType.AROMATIC: 3
    }
)

dicts = {"H":"A","R":"A","K":"A",
         "D":"B","E":"B","N":"B","Q":"B",
         "C":"C","X":"C",
         "S":"D","T":"D","P":"D","A":"D","G":"D","U":"D",
         "M":"E","I":"E","L":"E","V":"E",
         "F":"F","Y":"F","W":"F"}

protein_dict = { "A": 1, "C": 2, "B": 3, "E": 4, "D": 5, "G": 6,
                 "F": 7, "I": 8, "H": 9, "K": 10, "M": 11, "L": 12,
                 "O": 13, "N": 14, "Q": 15, "P": 16, "S": 17, "R": 18,
                 "U": 19, "T": 20, "W": 21,
                 "V": 22, "Y": 23, "X": 24,
                 "Z": 25 }

num_atom_feat = 34
def one_of_k_encoding(x, allowable_set):
    if x not in allowable_set:
        raise Exception("input {0} not in allowable set{1}:".format(
            x, allowable_set))
    return [x == s for s in allowable_set]


def one_of_k_encoding_unk(x, allowable_set):
    """Maps inputs not in the allowable set to the last element."""
    if x not in allowable_set:
        x = allowable_set[-1]
    return [x == s for s in allowable_set]

def smile_to_graph(smile):
    molecule = Chem.MolFromSmiles(smile)
    n_atoms = molecule.GetNumAtoms()
    atoms = [molecule.GetAtomWithIdx(i) for i in range(n_atoms)]

    adjacency = Chem.rdmolops.GetAdjacencyMatrix(molecule)
    node_features = np.array([atom_features(atom) for atom in atoms])

    n_edge_features = 4
    edge_features = np.zeros([n_atoms, n_atoms, n_edge_features])
    for bond in molecule.GetBonds():
        i = bond.GetBeginAtomIdx()
        j = bond.GetEndAtomIdx()
        bond_type = BONDTYPE_TO_INT[bond.GetBondType()]
        edge_features[i, j, bond_type] = 1
        edge_features[j, i, bond_type] = 1

    return node_features, adjacency

CHAR_SMI_SET = {"(": 1, ".": 2, "0": 3, "2": 4, "4": 5, "6": 6, "8": 7, "@": 8,
                "B": 9, "D": 10, "F": 11, "H": 12, "L": 13, "N": 14, "P": 15, "R": 16,
                "T": 17, "V": 18, "Z": 19, "\\": 20, "b": 21, "d": 22, "f": 23, "h": 24,
                "l": 25, "n": 26, "r": 27, "t": 28, "#": 29, "%": 30, ")": 31, "+": 32,
                "-": 33, "/": 34, "1": 35, "3": 36, "5": 37, "7": 38, "9": 39, "=": 40,
                "A": 41, "C": 42, "E": 43, "G": 44, "I": 45, "K": 46, "M": 47, "O": 48,
                "S": 49, "U": 50, "W": 51, "Y": 52, "[": 53, "]": 54, "a": 55, "c": 56,
                "e": 57, "g": 58, "i": 59, "m": 60, "o": 61, "s": 62, "u": 63, "y": 64}
                
def inputfile(dataset,fileinput):
    data=pd.read_csv(dataset,sep='\t')

    psmiles=data['psmiles']
    poly_smiles=data['poly_smiles']
    compound_smiles=data['smiles']
    label=data['logkd'].to_list()
    size=data['average size'].to_list()
    water=data['water3'].to_list()

    fingerprints,pgraph,morgan,graph,adjacencies,compound_yuyi,p_adjs=[],[],[],[],[],[],[]
    
    for psmiles in psmiles:
        finger = None  
        if psmiles =="[*]C=C[*]":
            finger=[-1.1860e-01,  1.8906e-01, -5.3704e-01, -1.0201e+00, -1.7724e+00,
        3.2157e-01,  1.1410e+00, -7.1621e-01, -9.2507e-01,  9.7720e-01,
        -5.4447e-01, -1.4643e+00,  1.4056e+00, -2.0565e+00, -7.5944e-01,
        -3.4900e-01, -1.5002e+00, -1.4102e+00, -6.4715e-01,  4.9821e-01,
        2.5312e-01,  1.3879e-01, -3.9117e-02,  1.0735e+00, -1.1318e+00,
        1.4391e+00,  4.4362e+00, -3.6129e-01,  3.8351e-01,  1.5226e-02,
        -8.7377e-01,  4.4888e-01, -5.1246e-01, -1.2029e+00,  1.0918e+00,
        7.3390e-01, -7.0121e-01,  1.4956e-01,  3.3090e-01,  1.4650e+00,
        -1.8804e-01, -2.5118e-01,  7.6507e-01,  7.3442e-01,  6.2470e-01,
        1.3219e+00,  1.5428e+00,  3.5732e-01,  1.4206e+00,  6.2580e-01,
        -3.8352e-01, -1.0958e+00, -8.4876e-01, -1.3720e+00,  1.3818e-01,
        2.7357e-01, -7.7707e-03,  7.2790e-02, -1.0526e+00,  7.2846e-01,
        2.0669e-01,  4.6471e-01,  1.9049e+00,  9.3030e-01,  5.8278e-02,
        4.4888e-01, -4.4110e-01, -8.4164e-02, -1.3986e+00,  3.1846e-01,
        -6.8122e-02,  1.0543e+00,  1.0147e-01, -6.9602e-01, -7.4482e-01,
        -9.1264e-01, -3.3519e-01, -1.0904e+00,  1.3148e+00,  4.2963e-01,
        7.5246e-02,  2.2388e-01, -1.6190e-02,  1.4151e+00, -1.4264e-01,
        2.3228e-01,  1.4652e-01,  1.0391e+00, -8.5365e-02,  7.6856e-02,
        -2.2835e+00,  6.1176e-01,  1.6403e+00,  4.3260e-01, -3.8033e-02,
        1.3168e-01, -1.2362e+00,  4.6338e-01, -2.5900e-02,  1.9612e-01,
         -1.2358e-01,  4.0470e-01, -1.3796e+00,  2.0993e+00,  1.9545e+00,
         -1.9214e+00,  6.8130e-01, -1.0593e+00, -1.1077e+00, -5.6478e-01,
         -2.7264e-01,  5.1050e-01,  4.5849e-01,  5.8535e-03,  1.4622e-01,
          1.4467e+00, -2.6834e-01,  9.0380e-01,  5.2122e-01, -5.7800e-02,
         -1.1896e-01,  6.5067e-02, -3.5734e-01, -7.1466e-01, -6.2671e-01,
         -2.5588e-01,  3.9105e-01, -1.1458e-01,  2.9616e-01, -1.2683e-01,
          3.3236e-02, -1.5611e+00, -9.8191e-02,  3.7986e-01, -1.3903e+00,
         -1.2425e-01,  9.1902e-02, -8.3220e-01, -2.9308e-01, -3.2008e-01,
         -1.4443e+00, -1.9946e-01,  9.4624e-02, -3.1831e-01, -8.2556e-01,
         -4.9911e-01,  1.3478e-01,  1.6953e-01, -3.4935e-01, -1.2473e+00,
         -1.0514e-01, -3.5366e-01,  1.3268e+00,  5.2143e-01,  9.1509e-01,
          1.8397e+00,  5.7406e-03, -1.0968e+00, -1.2470e+00, -8.9431e-01,
         -2.7726e-01, -5.7965e-01,  1.7656e+00,  1.0087e+00,  6.7973e-01,
         -8.8264e-01, -2.0203e-01,  3.4708e-02, -4.6201e-01,  9.8081e-01,
          9.3709e-01, -8.7227e-01, -1.3559e-01,  8.3868e-01, -2.4273e-02,
          1.9899e+00,  1.1430e+00, -6.6986e-01, -9.9209e-01,  5.2203e-01,
         -1.0451e+00,  1.4177e+00,  1.0666e+00, -3.1569e-01,  4.4462e-01,
          5.8938e-01,  4.6231e-01,  2.5636e-01, -3.8532e-01,  9.8202e-01,
         -1.5289e-01, -1.1806e-01, -1.6302e+00, -6.5989e-01, -2.1645e-01,
         -2.0623e+00,  3.9855e-01, -4.7452e-01,  2.6683e-01,  5.6993e-01,
         -1.3342e-01,  3.6379e-01,  7.1039e-01,  3.0621e-01, -9.8901e-01,
         -1.3040e-01, -5.5256e-01, -1.3021e-01,  4.4209e-01,  7.8812e-01,
         -1.0963e+00, -1.5430e+00,  1.1898e+00, -7.7687e-01,  5.0888e-01,
          9.1276e-01, -1.0556e+00,  1.0715e+00, -5.1812e-01, -2.0856e-01,
          5.9041e-01,  1.0085e+00,  5.3005e-01, -7.0526e-01, -7.0213e-01,
          6.4729e-01,  8.7072e-01,  9.8094e-01,  3.5406e-01, -3.6676e-01,
         -2.3424e-01,  2.6779e+00,  3.7050e-03, -1.0827e+00,  2.6263e+00,
          1.7772e+00, -1.0911e+00, -1.1364e+00, -6.8051e-01,  1.3043e-01,
         -2.7811e-01,  1.1498e+00, -5.0364e-01,  1.6171e-01,  5.6418e-01,
         -1.5894e+00, -6.8151e-01, -1.9136e-01,  7.1351e-01,  4.8992e-01,
          3.9108e-02,  8.4738e-01, -5.1758e-01,  5.5564e-02, -2.9379e-01,
          1.6418e-01, -1.2846e+00, -3.8817e-01,  1.3133e+00,  3.1187e-01,
         -1.1851e+00, -6.4066e-02, -6.3905e-01, -7.1414e-01, -5.3036e-01,
          1.6730e+00,  8.8204e-02,  5.4634e-01, -1.0499e+00,  1.6174e-01,
         -1.0152e+00, -2.6244e-01,  5.5906e-01,  6.9206e-01, -2.5497e-01,
          6.1739e-01,  9.5267e-01, -2.2210e-01, -7.8515e-01, -9.4519e-01,
          5.6731e-01, -1.1722e+00,  2.3273e+00,  8.0240e-01, -5.0875e-01,
         -2.9879e-01, -4.8456e-01,  1.1575e+00,  8.2772e-02,  5.4545e-02,
          1.0991e-01, -1.4051e+00,  1.9291e+00, -2.7079e-01,  1.5982e+00,
          4.2864e-01,  1.2820e+00, -1.4783e-01, -6.9786e-01,  1.4537e-01,
         -6.6485e-02,  6.2526e-02,  5.3103e-01,  6.2482e-01,  5.0511e-01,
          2.8569e-02,  1.5181e+00,  4.7674e-01,  1.1093e+00, -2.6288e-01,
         -8.9539e-01, -6.6816e-02, -5.2719e-01,  8.2227e-01,  1.2848e+00,
          6.1713e-02,  1.4567e-01, -1.2083e+00,  1.0014e+00,  9.4807e-02,
          1.9091e+00, -4.0706e-01,  3.4613e-01, -1.5196e-01,  8.9745e-01,
          2.2372e-01, -4.2660e-01, -4.7918e-01,  9.1804e-01,  3.4993e-01,
          3.9075e-01, -2.2570e+00,  4.9555e-01, -5.4398e-02,  4.9780e-01,
          1.1226e+00, -5.7374e-01, -8.0296e-01,  3.0315e-01, -1.8112e-01,
         -9.3474e-01,  1.5751e+00, -1.5577e+00, -5.3483e-01,  1.5756e-01,
          5.1182e-01,  1.2305e+00,  7.7426e-01,  1.0732e-01,  6.9747e-01,
         -5.7976e-01, -1.6288e+00,  5.0489e-02,  5.7975e-01,  2.3670e-01,
          1.6405e+00, -4.9288e-01, -1.1950e-01,  1.1792e+00,  3.9366e-01,
          7.9063e-01, -1.1212e-01, -2.2558e+00, -2.2241e-02, -1.8362e-01,
          8.2902e-01, -1.1483e+00, -4.0498e-01, -5.1578e-01,  4.2115e-01,
          4.0123e-01,  1.0645e-01, -1.6049e-01, -2.9788e-01, -1.1550e+00,
         -7.2410e-01, -2.9962e-01, -7.0936e-01,  2.2849e-01, -2.6381e-01,
         -1.8530e-01,  3.6917e-01, -6.1905e-01, -6.5865e-01, -1.3088e+00,
          2.1415e+00,  4.0530e-01, -1.1331e+00,  3.9147e-01, -1.0746e+00,
         -8.2908e-01,  8.6427e-02, -3.7467e-01, -2.5006e-01, -1.3100e+00,
          1.2190e+00,  1.4936e-01,  1.1285e+00,  1.5015e+00,  8.3531e-01,
          2.1610e-01,  1.8520e+00, -5.4619e-01,  3.1403e-01,  2.6286e-01,
         -8.2236e-01, -6.1081e-01,  3.8787e-03, -4.2046e-01, -1.5101e-01,
          2.9203e-01,  3.2830e-01,  1.1744e+00, -1.1847e+00,  9.2403e-01,
          1.7616e-01,  7.2963e-01,  1.5319e-01, -9.0004e-02, -1.1396e-01,
          1.0542e+00,  1.3421e+00,  5.3526e-01, -1.5150e-01,  1.1262e-01,
          7.4955e-02,  1.1643e+00, -2.4069e-01,  4.9206e-01, -6.7585e-01,
         -1.4168e+00, -6.7302e-01, -1.4780e+00,  9.8677e-01, -7.2600e-01,
         -1.4496e+00, -1.2870e-01, -7.9010e-01, -1.8629e+00,  6.9218e-01,
         -8.0150e-01, -8.2112e-02, -8.2018e-01, -4.1768e-01, -4.1509e-02,
         -7.4013e-01,  1.0060e+00, -1.8883e-01, -1.4148e+00,  1.4502e-01,
         -4.4314e-01,  1.8991e-01, -1.8076e+00,  3.9364e-01, -7.4352e-01,
         -1.1609e+00,  5.4793e-01,  5.5439e-01,  1.1989e+00, -1.9014e+00,
          1.4184e+00, -2.3769e-01, -1.0992e+00, -1.4716e-03, -3.8409e-02,
         -2.5357e-02, -2.3186e-01, -3.3115e-01, -2.0149e-01, -3.5382e-01,
          1.9109e+00, -3.1040e-01, -1.0581e+00,  1.0386e+00,  5.2200e-03,
         -4.0092e-01, -3.5233e-01, -6.5827e-01, -3.5407e-01, -2.7251e-04,
          1.1282e+00, -6.5696e-01, -1.1299e-01,  5.4874e-01, -1.0946e+00,
         -5.8380e-01, -3.8774e-02,  4.2277e-02,  3.1822e-01,  1.1618e-01,
         -9.4945e-01,  1.6776e-01, -7.7520e-01,  9.6494e-02, -5.3751e-01,
         -1.0254e+00,  8.2451e-01,  4.2624e-01, -4.9592e-01, -1.3953e-01,
          3.8472e-01,  3.8849e-01, -1.4866e-01,  9.8197e-01,  4.7492e-01,
          2.7020e-01,  5.6322e-01, -1.2122e+00, -5.6783e-02, -4.7642e-02,
         -9.1330e-01, -6.2090e-01, -7.0602e-01, -7.4936e-02,  2.2074e-01,
         -4.8365e-01, -1.5435e+00, -3.7926e-01, -2.0643e+00,  8.7963e-01,
         -2.4146e-01, -8.2228e-01,  3.0404e-01, -7.3754e-01, -1.0888e+00,
         -1.0316e+00,  1.0716e-01,  8.4960e-01,  4.0621e-01,  1.2263e+00,
         -9.3657e-01,  5.5609e-01,  1.0876e+00, -1.2687e+00, -2.8437e-02,
          1.3658e+00, -8.3323e-01, -2.1635e-02,  1.5664e+00, -4.7081e-01,
          1.5270e-01,  8.6598e-01, -9.7541e-01, -1.3105e-01, -8.9630e-01,
         -2.9421e-01,  2.4046e-01,  4.5583e-02,  4.6748e-01,  3.7781e-01,
         -1.7199e-01,  1.2278e+00, -7.8783e-03,  1.1140e+00, -6.6811e-01,
          5.5272e-01, -3.2850e-02, -9.5536e-01, -7.9006e-01, -7.3313e-01,
         -2.3838e-01,  1.7806e+00,  1.9770e+00, -7.0081e-01, -5.1376e-01,
         -1.0764e+00,  1.7445e-01, -4.3315e-01,  5.5983e-01, -5.6957e-01,
         -4.5182e-01,  1.0111e-01, -3.8411e-01, -2.1225e+00, -7.6558e-01,
         -3.3386e-01, -1.5990e+00, -5.3512e-01, -2.9202e-03,  1.2342e+00,
          1.1837e+00, -8.6400e-01, -3.3159e-01, -3.2480e-02,  3.8530e-01,
         -2.9072e-01, -4.4114e-01,  7.1956e-02,  7.4631e-01,  7.4162e-01,
          5.3327e-01, -1.3021e+00,  3.5110e-01, -1.4219e+00,  7.5304e-02,
          6.8459e-01,  1.7998e+00, -8.7154e-01,  2.9789e-01,  6.7119e-01]
            fingerprints.append(finger)

        if psmiles == "[*]C=C[*]c1ccccc1":
            finger=[ 1.5863e-01, -1.5425e-01,  1.9606e-01, -9.7221e-01, -1.1231e+00,
         -3.6577e-01,  6.8061e-01, -3.5333e-01, -5.0726e-04,  8.7401e-01,
         -5.4959e-01,  2.5357e-01,  3.3332e-01, -1.5239e+00, -1.8342e+00,
         -1.1693e-01, -8.0632e-01, -1.4632e+00, -2.2899e-01, -6.5879e-01,
         -5.0866e-01, -4.2445e-01, -7.2517e-02,  8.0130e-01, -7.1348e-01,
          7.9644e-01,  3.4328e+00,  2.6484e-01, -9.8517e-01, -3.6960e-01,
         -4.0886e-01, -2.4915e-01, -6.1385e-01, -8.2422e-01,  6.1629e-01,
          6.6055e-01, -3.5075e-01, -3.7423e-01,  2.5844e-01,  8.1362e-02,
         -2.8092e-01,  4.3192e-01,  5.8135e-01,  6.3623e-01,  2.9571e-01,
          4.8514e-01,  1.1223e+00, -7.7947e-01,  1.2042e+00, -1.3326e-01,
          6.7980e-02, -7.1339e-01, -3.5355e-01, -9.5883e-01, -1.5144e-01,
          8.1685e-01, -1.0515e-01, -8.8927e-01, -2.1671e-01, -9.8355e-01,
          3.2699e-01,  1.0648e+00,  3.8169e-01,  5.7493e-01, -2.9863e-01,
          4.5107e-01,  7.0414e-01,  1.0303e-01, -1.2249e+00, -2.4192e-01,
         -4.0219e-01,  9.9385e-01, -6.6586e-01, -9.2256e-02, -3.8221e-01,
         -6.0357e-01, -4.5257e-01, -1.2903e+00,  8.9259e-01, -2.8484e-01,
          2.8889e-01, -3.9121e-01, -2.0569e-01,  1.3357e+00,  4.8228e-01,
         -3.3281e-01, -4.0464e-01,  1.0142e+00, -1.3191e-01, -2.0756e-01,
         -1.8803e+00, -4.9940e-01,  1.1195e+00,  1.6311e-01, -9.3129e-01,
         -8.4456e-01, -1.3077e+00,  1.2424e+00, -5.1899e-01, -7.2290e-01,
         -1.0213e+00,  1.0515e+00, -1.3203e+00,  7.0359e-01,  1.3946e+00,
         -4.6756e-01,  3.3472e-01, -1.0349e+00, -6.9943e-01,  8.9430e-01,
          4.5462e-01,  2.0801e-01,  7.3050e-01, -2.4764e-01, -9.9006e-01,
          1.0243e+00, -1.4042e-01,  5.1241e-01,  6.0540e-01,  1.9909e-01,
         -6.6622e-01,  8.8137e-01,  1.8378e-01, -3.1276e-01,  3.0256e-01,
          4.8593e-02, -2.3306e-02, -2.0251e-01,  2.3114e-01,  1.2925e-01,
          1.5821e-01, -6.8395e-01, -2.6698e-01,  1.9761e-01, -7.3937e-01,
          6.1001e-01, -7.4229e-01, -1.9078e-01, -7.9541e-01, -1.1138e-02,
         -1.2539e+00, -8.1581e-02,  3.8959e-01,  3.7187e-01,  1.0308e-01,
         -9.9813e-01, -3.8016e-02, -7.0629e-01, -3.3992e-01, -1.2789e+00,
          8.3566e-01, -1.0161e+00,  1.4963e+00,  5.2261e-01,  1.4817e-01,
          1.1378e+00, -3.1331e-02, -1.3767e+00, -4.9321e-02, -6.5961e-01,
         -7.3703e-02, -6.0484e-02,  1.4867e+00,  1.2083e+00,  9.1284e-01,
         -6.3766e-01, -1.4984e+00,  4.8451e-01,  1.0521e-01,  8.1415e-01,
          7.2956e-01, -1.4546e+00,  1.1743e-01,  3.1416e-01, -1.9308e-01,
          6.9654e-01,  2.0334e-01, -8.1312e-01, -4.1018e-01, -2.9984e-01,
         -1.3791e+00,  1.9728e+00,  7.1577e-02, -7.4310e-02, -1.5184e-01,
          6.0804e-01,  3.4053e-02,  5.4487e-01,  1.9167e-01,  1.3192e+00,
          2.0949e-01,  1.4246e-01, -5.7209e-01, -1.1231e+00, -3.4586e-01,
         -1.2695e+00,  5.5141e-01, -9.3226e-01, -5.9846e-01,  1.3458e+00,
          1.9361e-01,  2.2503e-01,  2.1484e-01,  1.9525e-01, -7.8065e-01,
         -3.5595e-01,  6.2646e-01,  2.0428e-03, -5.5379e-01,  8.4477e-01,
         -1.0279e+00, -8.1056e-01, -1.1963e-01, -5.8909e-01, -2.5688e-01,
          1.4969e+00, -2.9685e-01,  1.1811e+00,  1.5103e-01,  1.5791e-02,
          1.1523e+00, -4.6266e-02, -8.5093e-01, -6.5369e-02, -1.1521e+00,
          1.4552e+00,  1.0118e+00,  1.0109e+00,  1.0277e-02,  2.3929e-01,
         -4.4210e-01,  2.1919e+00, -8.4296e-01, -1.0208e+00,  1.3311e+00,
          1.4086e+00, -1.1662e+00, -1.1510e+00, -2.5929e-01, -3.3264e-01,
         -2.5344e-01,  7.3440e-01, -1.2439e-01,  1.3418e-01,  1.1452e+00,
         -5.9372e-02, -8.8250e-01, -7.1094e-01,  6.8442e-01,  3.8080e-01,
          6.7470e-02,  1.8840e-01, -5.3817e-01, -1.8628e-01, -8.8163e-01,
         -2.5295e-01, -3.4272e-01, -6.4924e-01,  1.4439e+00, -2.0234e-01,
         -6.2623e-01, -3.7426e-01, -1.0997e+00,  4.8643e-01,  1.4671e-01,
          1.2930e+00,  9.0596e-02,  1.6696e-04,  9.5717e-02, -6.0732e-01,
         -1.2966e+00,  1.1739e-01,  7.2699e-02,  1.4304e+00,  1.3589e-01,
         -1.5741e-01,  3.9236e-01,  8.2443e-02, -7.0246e-01, -4.0941e-01,
          9.2546e-01, -3.2428e-01,  3.4211e+00,  1.0396e+00, -1.7063e-01,
         -8.2716e-01, -2.4486e-01,  9.7997e-01, -8.1495e-02, -6.1812e-02,
          5.2516e-01, -4.6548e-01,  8.8779e-01,  3.5981e-01,  2.4328e-01,
         -2.0330e-01,  1.8904e+00, -7.7894e-01, -7.4923e-01, -1.3853e-01,
          5.0563e-01,  2.1442e-01,  8.5239e-02, -6.8365e-01,  4.5101e-01,
          3.0342e-01,  9.3092e-01,  3.6861e-01, -1.2747e-01, -1.5921e-01,
         -9.7284e-01,  3.3788e-01, -9.1448e-01,  8.3572e-01,  1.0590e+00,
         -8.4082e-01, -1.8932e-01, -5.1122e-01, -4.7018e-01,  6.0073e-01,
          1.8328e+00, -6.1512e-02, -1.1664e-01, -6.9516e-01,  8.2458e-01,
          7.5618e-01,  1.6468e-01, -4.0148e-01,  7.8906e-01,  7.8644e-01,
         -7.4359e-01, -9.9581e-01,  6.5225e-01, -1.2582e+00,  4.2119e-01,
          8.9297e-01, -6.3050e-01, -2.4577e-01, -6.1024e-01, -3.3375e-01,
         -5.1513e-01,  4.4461e-01, -1.2316e+00,  6.2203e-01, -5.9589e-01,
          6.1061e-01,  1.5046e+00,  1.2545e+00,  3.1897e-01,  1.0022e+00,
         -2.4226e-01, -8.6849e-01, -2.0730e-01,  1.4641e+00,  5.6702e-01,
          4.7738e-01,  7.9048e-02, -1.2044e-01,  1.5607e+00,  1.8215e-01,
         -6.2509e-01, -2.2188e-01, -2.4217e+00,  1.9761e-01,  2.9344e-01,
          1.1764e+00, -8.8565e-01, -3.4211e-01,  2.0300e-01,  6.2815e-01,
          3.5442e-01,  1.2184e-01,  1.4528e-02, -9.9284e-02, -1.1629e+00,
          3.1226e-01, -4.2502e-01, -3.4090e-02, -8.4627e-01, -3.0058e-01,
         -3.0945e-01, -2.4951e-01,  2.5807e-01,  5.3194e-01,  1.5989e-02,
          9.4299e-01,  6.5463e-01, -1.0476e+00, -5.1581e-01,  6.6105e-01,
         -1.4184e-01,  5.2758e-02, -8.7841e-02, -2.7178e-01, -9.1193e-01,
          3.3287e-01, -5.8804e-01,  7.3076e-01, -2.1319e-01,  1.1449e+00,
         -3.3816e-01,  1.4208e+00, -5.4359e-02,  8.9997e-01, -3.7542e-02,
         -8.2143e-01,  2.1332e-01, -1.2280e-01, -1.0952e+00, -5.5394e-01,
          4.5633e-01,  4.1275e-01,  1.3757e+00, -1.8070e+00,  2.9762e-01,
          4.2473e-01,  1.0801e+00, -3.6696e-01,  1.8437e-01,  4.1824e-01,
          2.9582e-01,  7.9105e-01,  5.5038e-01, -5.1989e-01, -3.0110e-01,
          8.2447e-01,  1.0147e+00, -6.0592e-01, -3.8974e-01, -2.6126e-01,
         -8.6809e-01, -9.8626e-01, -1.1775e+00,  1.1616e+00, -1.0960e+00,
         -1.2355e+00,  5.0396e-01, -1.4494e-01, -1.3356e+00,  3.6849e-01,
         -1.0960e+00, -2.3933e-01, -5.2568e-01, -1.0055e-01,  6.5635e-01,
          9.2437e-02,  5.9187e-01,  6.6543e-02, -8.7296e-01, -4.2593e-01,
         -4.7930e-01,  5.0427e-01, -1.4198e-01,  1.0938e+00, -9.8660e-01,
          2.2817e-01, -1.5494e-01,  4.3575e-01,  1.1775e+00, -1.2617e+00,
          1.0133e+00,  2.4713e-01, -1.1160e+00,  3.3819e-01, -8.5515e-01,
         -3.6717e-01, -4.2076e-01, -9.2360e-01,  4.7849e-01, -2.5808e-01,
          2.0161e+00,  2.6250e-01,  3.3619e-01,  4.0497e-01,  3.4601e-01,
          1.5422e-01, -1.8101e-01, -1.6228e+00,  7.9213e-02, -3.6907e-03,
          2.7851e-01, -3.2748e-01, -4.1763e-01,  5.2544e-01, -9.7049e-01,
         -1.7895e-01,  7.2482e-01, -1.9106e-01,  1.1447e-01,  6.6682e-01,
         -8.9672e-01, -5.1909e-01, -4.9758e-01, -2.8998e-01, -2.5427e-01,
         -2.9362e-01,  1.2039e+00,  9.0648e-01, -1.5397e-01, -1.5331e-01,
          1.1419e-01,  1.3270e-01, -2.2930e-01,  6.1975e-01,  3.6944e-01,
         -4.4506e-01,  1.7793e+00, -1.8263e+00,  3.7899e-01, -9.0804e-02,
         -1.0547e+00, -8.1884e-01,  1.5601e-01, -4.7793e-01,  1.1887e-01,
          2.3430e-01, -1.0000e+00,  2.7621e-01, -1.4239e+00,  6.3237e-01,
         -4.4011e-01, -4.3844e-01, -1.1664e-01,  8.9027e-02,  4.8227e-02,
          1.1128e-01,  4.0449e-01,  1.1053e-01, -2.3240e-01,  7.5323e-01,
          2.0280e-01,  3.3967e-01,  1.0164e+00, -1.0874e+00,  9.4312e-01,
          1.4109e+00, -5.9513e-01,  5.7877e-01,  1.3137e+00,  5.5775e-01,
          4.6965e-02,  5.2136e-01, -5.3061e-01, -2.9713e-01, -4.2781e-01,
          1.2696e+00, -3.9286e-01,  3.3695e-01,  5.1435e-01,  5.7480e-01,
         -5.1689e-01,  3.6601e-01,  9.6050e-01,  5.8126e-01, -8.5617e-01,
          5.7513e-01,  5.1628e-01, -1.7985e+00,  4.3334e-01, -5.0361e-01,
         -4.3296e-01,  7.7777e-01,  1.1053e+00, -5.8911e-01, -2.6810e-01,
         -7.0315e-01,  1.2653e+00, -2.4560e-01,  1.1364e+00, -1.2169e+00,
          5.5512e-03,  1.1200e-01, -1.5122e+00, -1.0403e+00,  2.0557e-02,
         -1.3670e-01, -2.3529e+00,  2.0354e-01,  1.5634e-02,  1.3619e-01,
          5.7600e-01, -1.0846e+00,  1.7370e-01, -8.8163e-02,  4.2258e-01,
         -5.9344e-01, -2.5322e-01,  2.4667e-01,  4.6122e-01, -4.4575e-01,
          7.2107e-01, -6.9029e-01, -3.2021e-01, -7.3672e-01, -3.3967e-02,
          3.4608e-01,  9.4162e-01, -2.9782e-01,  3.5770e-01,  5.9259e-01]
            fingerprints.append(finger)

        if psmiles =="[*]CC([*])C":
            finger=[ 6.5163e-01,  1.7682e-01, -4.4668e-01, -6.0389e-01, -1.9086e+00,
          2.3274e-01,  9.1329e-01, -6.3463e-01, -1.2082e+00,  1.2196e+00,
         -4.5634e-01, -5.9190e-01,  1.1301e+00, -1.9505e+00, -1.0390e+00,
         -6.5910e-01, -1.7913e+00, -1.2683e+00, -6.8653e-01,  3.6517e-01,
          9.5687e-01, -5.8921e-02,  5.9131e-01,  9.6959e-01, -1.2095e+00,
          1.8055e+00,  3.4739e+00, -5.9706e-02, -3.7116e-01,  3.5194e-01,
         -3.0874e-01, -8.6290e-01, -9.6683e-02, -8.7749e-01,  1.0232e+00,
          2.9763e-01, -5.7719e-01,  5.6340e-01,  8.0748e-01,  7.5411e-01,
         -9.4511e-01, -4.4167e-01,  7.5945e-01,  1.0064e+00,  7.5202e-01,
          1.1755e+00,  1.3869e+00,  3.3599e-01,  1.3455e+00, -3.2366e-01,
         -3.0898e-01, -8.1956e-01, -7.7749e-01, -6.8227e-01, -2.9211e-01,
          1.4970e-01,  2.7171e-01,  1.1672e+00, -8.8487e-01,  5.2636e-01,
         -3.7948e-01,  1.3764e-01,  1.3999e+00,  4.7485e-01, -4.4964e-01,
          3.9876e-01, -4.3332e-01, -1.5177e-01, -6.1497e-01, -3.3665e-01,
         -6.9621e-01,  8.9659e-01,  3.9568e-02, -1.6669e-02, -6.5682e-01,
         -4.4309e-01, -8.6811e-02, -7.5133e-01,  6.9053e-01, -7.5238e-01,
          3.7738e-01, -1.2763e-01,  4.6572e-01,  1.1750e+00, -3.0584e-01,
         -1.4559e-01,  3.2046e-01,  4.1168e-01, -9.0165e-02,  4.5607e-01,
         -2.2497e+00, -2.7201e-01,  1.1264e+00,  3.5699e-01, -2.6027e-01,
          1.0956e+00, -9.8024e-01,  5.8989e-01,  4.8977e-01,  4.6922e-02,
          1.5070e-01, -4.7195e-01, -1.6427e+00,  1.6560e+00,  1.7770e+00,
         -1.7347e+00,  8.6485e-01, -1.1849e+00, -3.9211e-01,  4.4978e-01,
         -7.3828e-01,  4.6344e-01,  5.7431e-01,  1.8377e-03,  5.1642e-01,
          1.2628e+00, -2.8361e-01,  1.4184e+00,  2.9618e-01,  4.2292e-01,
         -3.8977e-01,  6.0416e-01, -2.8219e-01, -1.1142e+00, -8.2982e-01,
          2.1611e-01,  2.0588e-01, -7.5800e-02,  3.0124e-03, -1.5540e-01,
         -2.7251e-01, -1.1163e+00, -2.3322e-01,  1.4179e-02, -1.0099e+00,
          4.6039e-03,  9.7462e-02, -5.8052e-01, -3.9809e-01, -5.9599e-01,
         -1.2749e+00,  3.1406e-01,  6.9084e-01, -7.6544e-01, -3.7975e-01,
          1.9348e-01, -1.6947e-01,  5.1830e-01, -4.1038e-01, -1.0902e+00,
          4.5021e-01, -6.9167e-01,  1.1298e+00,  1.7425e-01,  8.5344e-01,
          6.2850e-01, -4.3834e-01, -1.4973e+00, -1.1543e+00, -6.6514e-01,
         -5.6134e-01, -3.9069e-01,  1.3038e+00,  9.3300e-01,  8.2374e-01,
         -4.1856e-01, -3.2340e-03,  1.8800e-01,  3.5858e-01,  1.0443e+00,
          8.9355e-01, -7.9888e-01,  5.9348e-01,  5.0355e-01,  1.3077e-01,
          1.4674e+00,  5.5389e-01, -3.0175e-01, -7.0185e-01,  5.6206e-02,
         -1.2375e+00,  1.1560e+00,  6.7373e-01, -5.3789e-01,  4.2276e-01,
          6.8220e-01,  1.6930e-01,  8.2448e-01, -1.7697e-01,  5.9967e-01,
          2.0275e-01, -1.9814e-01, -1.2059e+00, -4.9450e-02,  1.9322e-01,
         -1.1008e+00,  7.6307e-01, -5.7658e-01,  8.6474e-02,  9.3435e-01,
         -3.1082e-01, -2.4142e-01,  8.9957e-01,  1.5191e-01, -6.6729e-01,
         -1.0196e+00, -2.6779e-01, -4.6033e-01,  2.7920e-02,  4.1014e-01,
         -1.2014e+00, -1.6020e+00,  1.1016e+00, -8.5706e-01, -9.6796e-02,
          5.9459e-01, -6.0869e-01,  5.1694e-01, -4.7699e-01,  6.0089e-01,
         -3.0241e-01,  4.1641e-01,  1.7244e-01, -3.4167e-01, -9.1510e-01,
         -6.0678e-03,  3.1664e-01,  1.0581e+00,  2.0661e-01, -3.7358e-01,
         -9.3844e-01,  3.0010e+00,  3.2028e-01, -5.3311e-01,  2.0033e+00,
          1.0973e+00,  2.1366e-01, -2.0198e-01, -6.0264e-01, -4.1459e-01,
         -5.5061e-01,  1.1627e+00, -8.7913e-01,  6.6293e-02,  3.2837e-01,
         -1.1637e+00, -3.8701e-01, -4.8395e-01,  4.4914e-01,  9.3108e-01,
         -2.6120e-01,  1.4480e-01,  1.0935e-01,  7.2081e-02, -6.6377e-01,
         -1.1110e-01, -7.2795e-01, -2.3763e-01,  2.0315e+00,  3.5427e-01,
         -8.4164e-01, -1.1530e+00, -1.3398e-01, -7.2584e-01, -4.2310e-02,
          1.0845e+00,  1.3552e-02,  4.8174e-02, -6.7409e-01, -1.1923e+00,
         -7.3074e-01,  1.7084e-01, -1.6694e-01,  6.1675e-01, -3.4294e-02,
          3.0670e-01,  6.3335e-01, -1.0659e-01, -6.8232e-01, -3.3222e-01,
         -2.8272e-02, -3.8898e-01,  2.1028e+00,  4.4918e-01,  7.3182e-01,
         -4.5833e-01,  1.6057e-01,  1.3308e+00,  1.3023e-01, -3.0506e-01,
          1.3914e-02, -7.1709e-01,  1.4977e+00, -7.0071e-02,  9.2052e-01,
          3.9569e-01,  1.2457e+00, -1.9398e-01,  9.7844e-02, -6.3561e-02,
          7.4560e-01, -7.3033e-02,  8.9155e-01,  1.2215e-01,  5.4312e-01,
          3.4007e-01,  1.6195e+00, -3.1428e-01,  5.5857e-01,  7.8759e-02,
         -1.9532e-02,  7.5580e-01, -4.2383e-01,  6.5016e-01,  1.0736e+00,
          4.5046e-01, -4.3285e-01, -1.3302e+00,  7.2076e-01, -6.8635e-02,
          1.0170e+00,  7.2767e-02,  7.1507e-01, -1.5126e+00,  8.7473e-01,
          4.0271e-01, -5.3547e-01, -3.9246e-01,  6.3846e-01,  4.0291e-01,
         -1.6703e-01, -2.0970e+00, -1.0151e-01,  1.1677e-02,  8.7513e-01,
          1.8821e+00, -4.5245e-02, -5.0571e-01,  9.6538e-02, -7.5172e-01,
         -1.2234e+00,  9.1144e-01, -1.0795e+00,  2.2935e-02,  4.5920e-01,
          1.5910e-01,  8.8085e-01,  1.0075e+00, -1.9040e-01,  4.7821e-01,
         -3.8118e-01, -1.7057e+00,  6.7611e-01,  6.0234e-01,  5.8763e-01,
          1.3137e+00,  1.3253e-01, -6.5330e-02,  5.8486e-01,  4.8132e-01,
          7.0333e-01, -3.2411e-01, -1.6389e+00, -3.7214e-01, -3.5547e-01,
          3.6186e-01, -9.2237e-01,  2.7959e-02,  4.2608e-01,  5.2706e-01,
         -2.4648e-01, -6.1922e-01,  1.2036e-01, -3.2362e-01, -4.4518e-01,
         -3.3064e-01, -2.7743e-01, -3.5551e-01,  1.2781e-01, -4.5909e-01,
         -8.6456e-03, -6.5781e-02, -1.6927e-01, -1.4050e+00, -9.6900e-01,
          7.7046e-01, -2.9220e-01, -1.0831e+00,  2.5650e-01, -6.3531e-01,
         -4.4986e-01,  3.2799e-01,  2.0739e-01, -7.5667e-01, -4.3590e-01,
          1.2517e+00,  3.1055e-01,  3.4083e-01,  8.5918e-01,  6.8982e-01,
          1.8487e-01,  1.2772e+00, -9.7806e-01, -8.2837e-04,  7.6860e-01,
         -6.6326e-01, -7.2914e-01,  2.2301e-01, -4.3030e-01, -1.8103e-01,
          4.7682e-01,  1.6088e-01,  9.1955e-01, -1.1933e+00,  8.8247e-01,
          4.1295e-01, -2.1050e-01,  6.4659e-01, -4.6610e-01, -3.4256e-01,
          1.0607e+00,  1.0942e+00,  9.6342e-01, -8.4533e-02, -1.1945e-02,
         -3.3657e-01,  1.2175e+00, -9.6726e-01, -3.0071e-01, -1.2610e-01,
         -1.3728e+00,  2.2517e-02, -4.5831e-01,  4.3481e-01,  2.8355e-02,
         -1.2465e+00, -2.4281e-01, -9.5449e-01, -1.6829e+00,  5.8854e-01,
         -1.0041e+00, -2.4718e-01,  1.8672e-02, -7.3564e-01,  8.4465e-02,
         -5.3368e-01,  1.2005e+00,  1.3227e-01, -1.3688e+00,  9.8998e-02,
         -2.3288e-01, -2.6717e-01, -1.1333e+00,  2.7026e-01, -1.0905e+00,
         -9.5629e-01,  1.5270e-01,  9.3979e-01,  9.8399e-01, -1.5638e+00,
          5.0490e-01,  1.7228e-01, -8.9889e-01,  3.8765e-01,  3.5475e-03,
          4.3501e-01, -3.4380e-01, -4.8150e-02, -3.6180e-01, -2.2619e-01,
          1.6961e+00, -3.8571e-01, -7.7978e-01,  8.2489e-01,  7.4866e-01,
         -4.8948e-01, -2.2559e-01, -3.6279e-01, -3.2212e-01, -1.8140e-01,
          1.1004e+00, -4.6361e-01,  9.6711e-01,  6.7342e-01, -1.6887e-01,
         -6.7826e-02, -5.7069e-01, -5.7177e-01,  3.9601e-01, -1.2176e-01,
         -6.5082e-01, -1.3131e+00, -5.0842e-01, -2.6904e-01, -7.0777e-01,
         -2.1720e-05,  1.1942e+00,  3.4321e-01, -3.8823e-01, -1.5610e-01,
         -1.7258e-01,  3.7846e-01,  3.0903e-01,  8.3229e-01,  2.2058e-03,
         -2.0209e-01,  9.6092e-01, -1.1713e+00,  9.8352e-02, -2.8064e-01,
         -1.0185e+00, -7.1526e-01, -4.5007e-01, -1.5030e-01,  4.3516e-01,
         -5.1519e-01, -1.1212e+00, -6.4206e-01, -1.4222e+00,  5.7150e-01,
          6.0118e-02, -3.8425e-01, -4.5890e-01, -7.5806e-01, -1.1108e+00,
         -1.0976e+00, -1.9782e-01,  4.0278e-01,  8.0529e-01,  1.1317e+00,
         -1.1577e+00,  1.2941e-01,  7.4362e-01, -5.2050e-01,  1.5811e-01,
          9.5612e-01, -4.3373e-01, -5.1443e-01,  1.0314e+00, -3.2605e-01,
          6.3275e-01,  7.7032e-01, -5.1908e-01,  3.7608e-01, -1.1623e+00,
          2.6188e-01,  1.0803e-01,  3.9537e-02,  6.9088e-01,  4.6369e-01,
         -4.1428e-01,  7.1690e-01, -4.1927e-01,  1.3424e+00, -4.4474e-01,
          1.1089e+00, -2.4484e-01, -3.9777e-01, -2.8685e-01, -7.0023e-01,
          1.0124e-01,  9.3755e-01,  2.2016e+00, -1.0723e+00, -4.9421e-01,
         -1.7881e+00,  2.9515e-01,  6.5106e-02,  5.8930e-01, -3.8211e-01,
         -2.3336e-01,  5.9687e-01, -6.0575e-01, -1.7292e+00, -8.8269e-01,
          1.0427e-01, -8.9003e-01, -6.6650e-01, -2.1316e-01,  1.1274e+00,
          1.2724e+00, -1.1556e+00,  4.4799e-01,  7.1672e-02,  2.9477e-01,
         -7.0333e-01, -1.4135e-01, -6.7206e-01,  8.9691e-01,  4.2359e-01,
          6.1361e-01, -7.7352e-01, -5.3678e-02, -1.1840e+00, -8.6419e-03,
         -1.5359e-01,  1.7580e+00, -1.4659e-01,  9.0533e-02,  7.2224e-01]
            fingerprints.append(finger)

        if psmiles == "[*]C=C[*]Cl":
            finger=[ 4.0801e-01,  1.3875e-01, -4.6253e-01, -9.1916e-01, -1.3821e+00,
         -3.9104e-01,  7.6936e-01, -1.7992e+00, -8.7835e-01,  1.1761e+00,
         -5.3793e-01, -5.9921e-01,  1.6231e+00, -1.3879e+00, -1.3355e+00,
         -4.0122e-02, -1.4552e+00, -1.7863e+00, -2.0837e-01,  3.7209e-02,
          2.1903e-01, -3.6706e-02,  2.1119e-01,  1.6872e+00, -1.0072e+00,
          9.2371e-01,  4.1706e+00,  4.3879e-01, -3.5128e-01, -1.5398e-02,
         -7.7939e-01,  5.6447e-01,  5.9557e-02, -1.4675e+00,  2.4783e-01,
          1.1637e+00, -1.4732e-01,  3.3179e-01,  6.4298e-01,  7.0974e-01,
         -7.4303e-01, -1.6636e-01,  6.1722e-01,  6.6397e-02,  5.5279e-01,
          1.5384e+00,  1.3647e+00, -5.0049e-01,  7.3820e-01,  6.3604e-02,
         -1.1204e-01, -1.5339e+00, -1.1521e-01, -8.7540e-01, -3.6217e-01,
          2.6602e-01, -3.5098e-01, -5.9220e-01, -1.0604e+00, -3.2008e-01,
          5.1338e-01,  2.8911e-01,  1.2383e+00,  9.1852e-01,  2.5180e-01,
          2.7797e-01,  4.5109e-02, -3.1806e-01, -1.2693e+00, -2.7553e-01,
         -3.5228e-02,  1.5129e+00,  1.1531e-01, -9.2504e-01, -6.6644e-01,
         -1.0470e+00, -4.3369e-01, -1.3772e+00,  1.2466e+00,  6.1988e-01,
         -3.1318e-01, -1.1821e-01,  8.2246e-01,  1.8235e+00,  6.0664e-01,
         -2.6522e-02, -2.0615e-01,  1.0574e+00,  8.7563e-02, -3.6628e-01,
         -1.5408e+00,  5.1806e-01,  1.8767e+00,  7.4812e-01, -1.2626e-03,
         -5.4198e-01, -1.3252e+00,  3.4635e-01,  2.5442e-01, -2.7766e-02,
         -6.4683e-01,  7.2956e-01, -8.7370e-01,  8.2800e-01,  1.4398e+00,
         -2.2597e+00,  6.4873e-01, -7.9295e-01, -2.2207e-01, -1.9236e-01,
         -2.8389e-01,  7.0473e-01,  9.1632e-01, -1.7038e-01, -4.4784e-01,
          1.3618e+00,  3.2136e-01,  8.2896e-01,  4.0360e-01,  5.9956e-02,
          4.4581e-02,  7.8375e-01, -2.3601e-01, -1.3284e+00,  2.0657e-01,
         -1.8986e-01,  3.8972e-01, -3.8858e-01,  2.9250e-01, -4.4524e-01,
          1.6854e-01, -1.4547e+00, -1.5573e-01, -6.0964e-02, -1.0891e+00,
          6.2559e-01,  5.7475e-01, -1.0453e+00,  5.1258e-03, -5.2583e-01,
         -1.5841e+00, -1.2883e-01,  5.8800e-01, -4.2685e-01, -3.9979e-01,
         -6.3981e-01,  2.9846e-01,  2.5632e-01, -8.6964e-01, -1.2067e+00,
          7.2624e-01, -3.4329e-01,  1.8371e+00,  2.6975e-01,  1.3919e+00,
          1.2204e+00,  3.3885e-01, -1.1430e+00, -6.4783e-01, -9.2851e-01,
          2.8954e-01, -9.1514e-01,  1.2194e+00,  1.5863e+00,  1.1959e+00,
         -6.8563e-01, -2.3103e-01,  7.9559e-01, -5.8836e-01,  1.0668e+00,
          4.1353e-03, -1.3705e+00, -7.8250e-01,  8.9429e-01,  1.1771e-01,
          1.1993e+00,  4.8207e-02, -4.4123e-01, -9.7877e-02,  5.0909e-01,
         -1.3152e+00,  1.6363e+00,  7.6020e-01, -8.8711e-01,  4.6654e-01,
          3.1074e-01,  2.0757e-01,  5.6280e-01, -4.8132e-01,  4.4100e-01,
         -5.5490e-01, -3.6798e-01, -9.6342e-01, -5.7484e-01, -1.2928e+00,
         -1.9270e+00, -1.9494e-01, -1.0535e+00,  1.6609e-01,  5.9723e-01,
          9.4856e-01,  3.5521e-01,  1.1076e+00, -1.0264e-01, -1.0766e+00,
         -2.1681e-01,  5.5204e-01,  6.1151e-01,  1.5445e-01,  1.9994e-01,
         -7.3998e-01, -1.7577e+00,  3.4119e-01, -1.1331e+00,  1.6963e-01,
          2.0114e+00, -6.5426e-01,  1.0801e+00, -3.2536e-01,  2.3234e-02,
          2.8739e-01,  7.2282e-02,  7.4141e-01, -3.7601e-01, -1.0716e+00,
          5.2008e-01,  5.7452e-01,  5.9896e-01,  1.6491e-01, -4.7041e-01,
         -7.7657e-01,  2.9855e+00, -2.7870e-01, -1.2310e+00,  1.9940e+00,
          1.9851e+00, -4.5685e-01, -1.5963e+00, -3.9573e-01, -5.4734e-01,
         -3.2795e-01,  9.1275e-01, -4.6958e-01,  3.0460e-01,  7.4400e-02,
         -1.5062e+00, -3.8991e-01,  1.2870e-01,  3.2006e-01,  6.8751e-01,
          8.6000e-01,  4.6107e-01, -4.7980e-01,  2.6224e-01, -1.8217e-01,
         -8.1430e-01, -4.9546e-01, -1.4713e-01,  2.2419e+00, -1.9884e-01,
         -7.4912e-01,  1.1534e-01, -3.3877e-02, -4.7853e-01,  9.5339e-02,
          1.5534e+00,  1.2372e-01,  9.8522e-01, -9.4150e-02, -5.5082e-01,
         -1.3210e+00,  1.3888e-02,  1.8896e-03,  1.8592e+00, -2.0100e-01,
         -8.8803e-02,  4.1727e-01,  6.5352e-01, -1.0601e+00, -9.7912e-01,
          3.1115e-01, -7.3207e-01,  3.2264e+00,  9.4028e-01, -2.1630e-01,
         -6.6790e-01,  1.1415e-01,  1.0556e+00, -5.8615e-02,  5.5867e-01,
         -1.7136e-03, -9.7542e-01,  1.4755e+00, -1.0871e+00,  1.0463e+00,
         -3.2823e-02,  1.1278e+00, -1.2718e+00, -4.6817e-01,  6.5942e-01,
         -1.4209e-01,  6.9744e-02, -4.5477e-01,  1.1958e-02,  1.2765e-01,
         -7.3425e-01,  1.6296e+00,  5.8399e-01,  5.9951e-01, -1.9308e-01,
         -8.6767e-01,  5.0641e-01, -6.3510e-01,  1.5440e-01,  1.4571e+00,
         -7.7325e-01,  3.8820e-01, -6.1549e-01,  2.9628e-01,  4.1542e-01,
          2.1402e+00, -2.8818e-01,  6.4026e-01, -2.8556e-01,  6.1925e-01,
          2.6302e-01, -5.1633e-01, -9.0106e-01,  3.5219e-01,  2.9493e-01,
          3.3165e-01, -1.4831e+00,  2.2659e-02, -1.6022e-01,  2.6642e-01,
          9.9405e-01, -1.1148e-01, -6.2160e-01,  1.5148e-01, -1.0956e+00,
         -9.3524e-01,  4.2294e-01, -2.0942e+00, -6.7147e-02, -1.7517e-01,
         -1.0899e-01,  9.1848e-01,  9.2670e-01,  4.2067e-01,  1.0162e+00,
         -5.1186e-01, -9.7365e-01, -5.2428e-01,  1.0174e+00,  4.9427e-01,
          9.7093e-01,  8.1405e-02, -1.1045e-01,  9.3512e-01, -4.0604e-01,
         -1.7090e-03,  1.9972e-01, -2.6407e+00, -3.6195e-01, -2.2355e-01,
          1.0113e+00, -1.2672e+00,  1.7185e-01, -8.5699e-01,  5.2601e-01,
          8.2035e-01,  5.6077e-01,  5.2312e-01,  4.4672e-01, -9.8657e-01,
          7.1165e-02, -2.7173e-01, -8.0297e-01,  1.7297e-01, -6.1922e-01,
         -1.9137e-01, -6.8267e-01,  1.2875e-02,  2.7179e-01, -1.0868e+00,
          1.2131e+00,  7.1935e-01, -1.5279e+00,  3.6554e-01, -6.5976e-02,
         -8.8892e-01,  2.2240e-01, -5.2635e-01, -8.0871e-01, -1.2657e+00,
          1.0983e+00, -3.2492e-01,  6.2188e-01,  9.8709e-01,  9.9165e-01,
          2.8283e-01,  1.3076e+00, -2.7034e-01,  4.9700e-01,  5.6563e-02,
         -1.6919e-01, -1.4903e-01,  3.5865e-01, -1.1286e+00,  9.1616e-01,
          2.2643e-01, -1.1988e-01,  1.0097e+00, -1.6312e+00,  4.9948e-01,
         -6.6851e-02,  4.9134e-01,  1.8618e-01, -1.5255e-01,  3.8896e-02,
          8.9520e-01,  1.5848e+00,  8.0635e-01, -3.3913e-01, -4.2280e-01,
          8.0829e-01,  1.2522e+00, -6.9828e-01,  3.3125e-01, -4.4903e-01,
         -7.1958e-01, -3.8071e-01, -1.3747e+00,  1.3105e+00, -6.2046e-01,
         -3.5975e-01,  7.2602e-01, -7.2107e-01, -1.2595e+00,  1.1160e+00,
         -8.6056e-01,  6.3600e-01, -1.4529e+00, -5.6370e-01, -9.6343e-02,
         -6.9474e-01,  1.2458e+00, -5.3004e-01, -1.5661e+00,  4.7245e-01,
          2.7897e-01, -1.4725e-01, -1.5029e+00,  3.9011e-01, -3.3232e-01,
         -6.6328e-01, -1.0082e-01,  4.7172e-01,  1.8932e+00, -2.1573e+00,
          1.3328e+00, -3.4542e-01, -9.4852e-01,  6.7126e-01,  4.3509e-01,
         -2.7984e-01, -2.9372e-01, -1.2515e+00,  3.2675e-01, -1.3627e-01,
          1.6816e+00,  4.4412e-01, -1.4066e+00,  1.2090e+00,  5.3858e-01,
         -2.4596e-01, -1.3304e-01, -5.7948e-01, -2.7890e-01,  3.2260e-02,
          8.2495e-01, -2.9398e-01, -6.0246e-01,  3.0550e-01, -9.8161e-01,
         -9.1466e-02, -3.1776e-01,  3.9276e-01, -6.7320e-02,  1.1466e+00,
         -1.2757e+00, -5.3805e-01, -2.5865e-01,  3.7243e-01, -5.6934e-01,
         -4.8533e-01,  1.0326e+00,  7.3021e-01,  2.3913e-01, -6.6869e-01,
          2.4248e-01,  1.1516e+00, -1.8705e-01,  2.1839e-04,  3.0257e-01,
          1.2359e-01,  1.2522e+00, -2.0966e+00,  5.6527e-01, -1.6388e-01,
         -5.9448e-01, -1.1896e+00, -7.5311e-01, -9.0253e-01,  4.4744e-01,
         -1.0566e-01, -1.6554e+00, -2.6676e-01, -1.6105e+00,  1.0939e+00,
         -9.4626e-02, -6.1273e-01,  4.8097e-02, -2.2144e-01, -1.2675e+00,
         -5.1519e-01,  4.7090e-01,  5.3266e-01, -3.8914e-02,  1.0982e+00,
          1.9252e-02,  4.5657e-01,  5.8472e-01, -8.2514e-01, -3.6030e-01,
          9.8319e-01, -6.4564e-01,  8.1529e-02,  1.4180e+00,  3.7686e-01,
          4.3111e-01, -7.6274e-02, -4.9895e-01,  2.7742e-02, -5.0496e-01,
          9.4949e-01, -3.2437e-01, -1.3773e-01,  1.4879e-01,  3.1605e-01,
         -6.5255e-01,  1.2835e+00,  5.4733e-01,  1.0747e+00, -8.2637e-01,
          4.5927e-01, -2.8505e-01, -1.6656e+00, -4.2109e-01, -3.5338e-01,
         -3.1817e-01,  1.6896e+00,  1.4789e+00, -4.9865e-01, -5.6859e-01,
         -6.6099e-01,  2.6880e-01, -4.6305e-01,  9.8781e-01, -7.3145e-01,
         -4.1119e-01, -3.5338e-01, -2.9794e-01, -1.6705e+00, -7.4972e-01,
         -1.7382e-01, -1.9129e+00, -2.9833e-01, -5.9415e-01,  8.3460e-01,
          7.6253e-01, -1.8160e+00,  5.3041e-01, -4.3541e-01,  4.7557e-01,
         -6.0175e-01, -4.8288e-01, -4.9959e-01,  7.6561e-01,  4.1790e-01,
          1.0081e+00, -6.7424e-01,  1.9055e-01, -8.5200e-01,  7.6829e-01,
         -3.1465e-01,  1.9634e+00, -1.0939e+00,  4.2121e-01,  3.4729e-01]
            fingerprints.append(finger)

        if psmiles =="[*]OCCOC(=O)c1ccc(C([*])=O)cc1":
            finger=[ 5.5607e-01, -1.4285e-01,  1.0411e+00,  3.5814e-01, -1.1460e+00,
         -1.8394e-01,  6.8293e-01, -4.9369e-01, -7.3937e-01,  6.5914e-02,
          4.0746e-01, -1.7101e-01,  1.1775e+00, -6.7570e-02, -5.3250e-01,
         -4.0992e-01, -1.1994e+00, -6.1202e-01, -7.1732e-01, -7.1665e-01,
          5.4474e-01,  4.3902e-01,  8.3612e-01,  4.2736e-01, -6.2938e-01,
         -1.1443e-01,  3.0925e+00,  8.4391e-01, -6.8595e-01, -4.6842e-01,
          3.7217e-02, -1.0934e+00, -2.8979e-02, -1.0149e+00,  9.8255e-01,
          5.4443e-01,  3.7477e-01,  6.2565e-01, -2.2935e-02,  1.5676e-01,
         -3.8731e-01,  3.5332e-01,  2.9590e-01,  5.9388e-01,  6.3543e-01,
          4.7972e-01,  6.2797e-01, -2.9528e-01,  6.6956e-01, -1.3810e-01,
         -3.0613e-01, -4.3374e-01, -1.5415e-01, -6.5382e-01, -5.0565e-01,
          7.9742e-02, -1.2631e-02,  3.6730e-02, -4.1998e-01, -6.7370e-02,
          4.1954e-01,  1.5311e-01, -6.0307e-01,  1.1157e+00, -7.8623e-02,
          4.8844e-01,  1.2833e-02, -5.8170e-01,  2.3683e-01, -7.3436e-01,
         -3.6698e-01,  3.0056e-01,  5.6416e-01, -5.4589e-01, -5.3105e-01,
         -7.4361e-02, -1.1170e+00, -6.9633e-01,  3.7944e-01, -9.2891e-01,
          9.0794e-01, -1.9389e-01, -1.5478e-01, -2.0975e-01, -5.0289e-01,
          2.1700e-01,  3.9194e-01,  5.9080e-01,  3.5523e-01, -2.0123e-01,
         -1.5855e+00, -7.0700e-01,  2.1579e-01, -2.6717e-01,  1.0357e-02,
         -6.1964e-02, -2.4275e-01,  1.7292e+00,  3.8882e-02,  1.8888e-01,
         -3.3845e-01, -7.1261e-02, -2.7720e-01,  5.4402e-01,  8.7794e-01,
         -1.1795e+00,  1.1776e+00, -1.1706e-01, -6.6948e-01,  1.7614e+00,
          1.6739e-01, -4.1315e-01, -1.4414e-01, -1.5392e-01, -1.8996e-01,
          1.0245e+00, -7.9848e-01,  1.2359e+00, -4.7210e-01,  1.0082e+00,
         -4.0017e-01,  6.4243e-01, -7.3267e-01, -3.7431e-01, -8.4894e-01,
          1.9766e-01,  2.9606e-01,  1.8750e-01, -3.0892e-01, -1.3733e-01,
         -1.3162e+00, -1.1445e-01,  6.1891e-02,  7.2176e-02,  2.1490e-01,
          5.0344e-01,  2.9796e-01,  7.4822e-02, -6.5909e-01,  3.5600e-04,
         -1.3848e-01,  2.2659e-01,  1.0258e+00, -1.5378e+00,  1.6117e-02,
          1.5015e-01, -2.3746e-01, -9.5744e-01, -6.5693e-01, -1.0339e+00,
          1.5082e-01,  6.6621e-02,  1.2311e+00,  9.1434e-02,  3.2833e-01,
          6.0758e-03, -6.7430e-02, -9.7262e-01,  9.3490e-02,  6.5609e-02,
         -2.5087e-01, -4.2571e-01,  2.5651e-01, -1.6006e-01,  1.0436e-01,
         -8.2988e-01,  3.8302e-01, -3.7765e-01, -4.3065e-01,  1.0603e+00,
          1.0539e+00, -3.0470e-01,  4.0932e-01,  1.3944e+00, -8.4902e-02,
          5.1284e-01, -9.6255e-02, -1.9638e-02, -1.0876e+00,  2.5607e-01,
         -3.2893e-01,  1.2733e+00, -5.3785e-01, -4.9721e-01, -2.6170e-01,
          6.2877e-01, -5.5665e-01, -5.1865e-01, -1.2084e+00,  4.2014e-01,
         -2.0571e-01,  4.0740e-01, -8.6775e-01, -9.0095e-01,  6.0555e-01,
         -5.0094e-01,  6.1080e-01,  4.9972e-01,  3.8961e-01,  1.4228e+00,
          5.1986e-01, -3.9448e-01,  2.6529e-01,  2.8622e-03, -7.7741e-01,
          1.5493e-01, -3.4025e-01,  7.2293e-01,  4.9403e-01,  3.2045e-01,
          2.6143e-01, -3.1249e-01,  1.1805e+00, -9.2373e-01, -8.5060e-01,
          7.8287e-01,  3.2134e-01,  1.3576e-01,  2.0692e-01,  1.0267e+00,
         -4.6149e-01,  2.4342e-01,  8.0613e-01,  3.1492e-01, -1.1802e-01,
          2.7097e-01,  8.6324e-01,  1.0448e+00,  5.1856e-01, -4.6794e-01,
         -6.9420e-01,  9.5913e-01, -1.2088e-01,  3.6649e-01,  1.0570e+00,
         -3.5222e-01, -1.2258e+00,  1.6454e-01,  3.2747e-01, -6.8382e-01,
          2.9511e-01,  1.3030e+00, -3.7108e-01, -1.4991e-01, -1.1144e-01,
         -1.7744e-01, -4.6343e-01, -4.2154e-01,  5.6174e-01,  1.9937e-02,
         -6.3860e-01,  4.2450e-01, -1.0736e-01,  2.6870e-01,  4.0174e-01,
         -4.8454e-02, -1.0399e+00, -4.6925e-01,  3.4697e-01, -6.0596e-01,
          5.9358e-02, -1.7931e-01, -2.1281e-02, -8.3697e-01, -3.4427e-01,
          3.5108e-01,  9.2768e-01,  7.8572e-02, -6.7837e-01, -4.6507e-01,
         -1.3480e+00,  3.4890e-02, -9.8800e-01,  7.4305e-01, -2.6347e-01,
         -2.4258e-01,  2.3163e-01,  1.2106e+00, -2.7097e-01, -1.5621e+00,
          3.0991e-01, -1.6577e-01,  5.0358e-01,  4.7982e-01,  5.5278e-01,
         -2.5910e-01, -5.1271e-01,  3.0222e-01,  9.7784e-02, -2.2130e-01,
          4.2054e-01, -4.6895e-01,  1.2224e+00,  4.1165e-01,  1.4590e-01,
          4.5162e-01,  1.9882e+00, -5.5117e-01,  1.2742e-01, -3.1821e-01,
          3.6341e-01,  1.1389e-01,  2.5110e-01, -1.9292e-01,  7.3398e-01,
          3.6600e-01,  7.9156e-01, -1.1128e+00, -4.1708e-01, -6.0798e-01,
         -1.9981e-01, -6.5985e-01,  3.1071e-01,  8.4536e-01,  8.9777e-01,
          1.6504e-01, -4.8653e-01, -6.7041e-01, -6.2841e-01, -1.0529e-01,
          3.0835e-01,  6.1762e-02,  3.1434e-02, -3.8744e-01, -5.2615e-01,
          3.8619e-01,  1.5724e-01, -6.9734e-01,  9.3857e-01, -2.8054e-02,
         -2.2327e-01, -1.2170e+00, -1.1118e+00,  7.3286e-01, -1.1030e-01,
          1.9462e+00, -7.8599e-01,  6.6431e-01,  1.5808e-01, -8.2600e-02,
         -8.3144e-01,  3.4877e-01,  1.2012e-01, -1.2808e-01,  6.1765e-01,
         -3.9902e-01,  1.4226e-01,  8.4118e-01,  7.2746e-02, -3.2402e-01,
         -9.9177e-01, -4.3690e-02,  5.5717e-01,  1.5829e+00, -1.3652e-01,
          3.4741e-01,  1.0884e-01,  7.1977e-01,  1.1762e+00,  3.2821e-01,
          2.4143e-01,  1.9332e-01, -1.4550e+00, -6.8602e-02, -2.9302e-01,
          3.1196e-01, -6.6918e-01, -4.5298e-02,  5.7159e-01,  1.6371e-01,
         -7.8344e-01,  1.2795e-01, -6.7772e-02, -4.9585e-01,  1.0376e-01,
         -8.6431e-02,  4.1608e-02, -8.3549e-03, -2.6726e-01, -6.1807e-01,
         -2.9816e-01, -7.4333e-01, -3.1887e-01,  1.7307e-01,  2.5127e-02,
         -7.4251e-02, -7.3766e-01, -1.2203e+00, -5.9353e-01,  1.4920e-01,
          8.9531e-01, -2.3865e-01,  5.0511e-01, -9.0509e-01, -5.0857e-01,
          7.5004e-01, -3.4055e-01,  3.9247e-01, -4.9984e-01,  1.0363e+00,
          1.9875e-01,  7.8871e-01,  1.0647e-01,  1.3098e-01,  7.2140e-01,
         -5.1021e-02,  5.6170e-01, -6.8160e-02, -6.9235e-01, -3.0788e-01,
          3.9559e-01,  6.5357e-01,  3.8966e-01, -8.6124e-01,  3.5032e-01,
         -1.2800e-01, -5.3059e-01,  2.9416e-01, -1.3291e-02, -1.4882e-01,
          4.4131e-01,  2.9170e-01,  6.7314e-03, -3.0883e-01, -1.8555e-01,
         -7.9529e-01,  1.0118e+00, -1.1318e+00, -2.5951e-01, -2.2080e-01,
         -1.0429e+00, -3.4268e-01, -8.5879e-01,  5.0938e-01,  6.4344e-02,
         -3.9302e-01, -1.5576e-01, -1.3450e+00, -4.3472e-01,  4.2385e-01,
         -4.5401e-01,  4.9527e-01,  1.7799e-01,  7.2299e-02,  1.0544e+00,
         -2.2488e-01, -1.4104e-01,  4.6198e-01, -1.0099e+00,  1.5916e-01,
         -2.2487e-01, -5.9940e-01, -1.2560e-01,  1.5208e-02, -1.3903e+00,
         -7.5629e-01, -5.1069e-01,  1.5308e-01,  3.4830e-01, -8.6948e-01,
          1.1270e+00, -5.6548e-01, -1.7967e-01, -8.8850e-01, -1.3945e-02,
         -2.0515e-01, -6.6377e-01,  7.3206e-01,  1.8767e-02,  2.9409e-01,
          1.5347e+00, -5.8683e-01, -3.5235e-01,  7.0655e-01,  1.9817e-01,
          1.3676e-01, -1.6280e-01, -7.0400e-01,  1.1388e+00,  6.1270e-01,
         -3.1889e-01, -3.0311e-01, -2.6145e-01,  3.8226e-01, -5.7147e-01,
         -8.1180e-01,  3.4189e-01, -1.2028e+00, -1.3635e+00,  1.3436e+00,
         -3.8587e-01, -4.8069e-01, -7.6730e-01,  6.2416e-01, -4.4103e-01,
          1.5085e-01,  2.5793e-01,  1.5482e-01,  1.5276e-01, -1.3421e+00,
          2.4369e-01,  4.3920e-01,  1.0356e+00,  1.5049e+00,  2.2894e-02,
          1.8576e-01,  1.9523e+00, -1.0943e+00, -8.4649e-02,  2.8674e-02,
         -5.2954e-01, -6.7628e-01,  6.8930e-02,  2.4810e-01,  2.7446e-01,
         -5.7066e-01, -1.2998e-01, -2.3579e-01, -5.7633e-01, -4.5287e-01,
          5.9912e-02,  3.6187e-01, -4.6391e-01, -5.6314e-01, -1.4877e-01,
         -4.7530e-01,  3.6024e-02, -9.7743e-01,  7.9185e-02,  3.7826e-01,
         -1.6106e-01,  6.8993e-02,  7.5064e-01,  1.7717e-01, -6.6493e-01,
          9.7384e-02, -5.2471e-01,  7.5693e-01,  1.5337e+00, -1.1255e+00,
         -4.1107e-03,  2.3372e-01, -6.1227e-01,  7.2772e-01, -1.9717e-01,
          6.3268e-02, -2.9724e-01, -2.0828e-02,  4.9186e-01,  7.5125e-01,
         -1.0835e-01,  1.1272e-02,  1.4644e-01,  8.3217e-01, -2.1248e-01,
          9.0626e-01, -2.0169e-02, -5.0319e-01,  1.0752e+00,  1.2346e-01,
         -4.6988e-01,  3.4808e-01,  7.2191e-01, -5.1302e-01,  3.0443e-01,
         -2.2923e-01,  4.3465e-01,  2.0651e-01,  7.2073e-01, -1.9149e-01,
         -1.6856e-01,  4.7941e-01, -3.7721e-01,  5.6807e-01, -6.7212e-01,
          6.0289e-01, -5.6151e-01, -6.2634e-01, -2.3671e-01,  5.4757e-01,
          7.8407e-01, -6.3093e-01, -8.4372e-01,  3.7356e-01, -1.9251e-01,
         -1.0806e+00, -6.0448e-01, -5.6377e-01,  1.5486e+00, -3.8795e-01,
          9.1119e-01,  9.5608e-02, -1.5302e-01, -2.7321e-01, -5.6934e-01,
         -2.7007e-01,  6.9512e-01, -8.2022e-02,  4.6559e-02,  5.7866e-01]
            fingerprints.append(finger)


        if psmiles=="[*]NCCCCCCCC(=O)[*]":
            finger=[ 4.5769e-01,  5.8390e-01, -4.4196e-01, -8.0783e-01, -1.4039e+00,
         -5.0230e-01,  6.2160e-01,  2.4406e-01, -7.4342e-01,  1.7960e+00,
          3.4057e-01,  1.2300e-01,  5.1821e-01, -1.7205e+00, -1.7051e+00,
         -3.8599e-01, -1.1501e+00, -7.0377e-01,  2.8780e-01,  5.3660e-01,
         -3.8664e-01, -2.5968e-01, -8.0108e-01,  2.2144e-01, -1.1110e+00,
          1.3851e+00,  3.1075e+00,  3.9532e-01,  4.7552e-02,  2.5250e-01,
         -7.6809e-01, -2.3166e-02, -4.6220e-01, -1.4331e+00,  8.6266e-01,
          8.3670e-01, -3.3840e-01,  1.1717e-01, -1.3090e-01,  4.5232e-01,
         -6.2066e-01,  5.8204e-01,  4.3843e-01,  3.3730e-01,  3.8261e-01,
          4.1065e-01,  3.3126e-01, -9.6462e-02,  5.6169e-01, -1.2383e+00,
         -5.0742e-01, -7.2660e-02, -7.3028e-02, -5.0166e-01,  5.0365e-01,
          4.1150e-01, -7.1590e-01,  3.4865e-01, -5.3167e-01, -5.0318e-02,
          1.6539e-01,  6.8768e-01,  9.3466e-01,  2.7674e-01, -4.9614e-01,
          1.4975e+00, -2.9232e-01,  1.6790e-02,  2.4645e-01,  4.1499e-01,
         -2.7731e-01, -1.1987e-01,  2.4983e-01, -1.0732e+00, -3.7538e-01,
         -1.4992e+00, -1.8738e-01, -7.5681e-01, -3.1172e-02,  1.5144e-01,
          3.5338e-01, -1.1209e+00,  9.0039e-01,  7.1728e-01,  2.9018e-01,
         -4.2268e-01,  6.6269e-01,  9.9053e-01,  1.9522e-02, -1.2679e-01,
         -1.2809e+00,  3.3793e-01,  1.0012e+00,  8.3548e-01, -1.0682e+00,
         -5.4222e-01, -1.6002e+00,  4.8087e-01, -3.8968e-01, -2.1027e-01,
         -5.8307e-01,  8.0904e-01, -9.9565e-01,  9.6810e-01,  1.2850e+00,
         -1.4069e+00,  6.1322e-02, -3.1799e-01, -3.8765e-02, -4.9716e-01,
          2.0394e-01,  9.6367e-01,  1.1058e-01,  1.1222e-01,  7.2364e-01,
          1.2071e+00,  3.6088e-01,  2.1032e-01,  1.4130e-01, -6.3668e-01,
          2.0701e-01,  9.1418e-01, -1.2067e-02, -7.9173e-01, -3.6973e-01,
         -3.2952e-01,  9.4353e-02, -7.8613e-02, -1.4888e-01, -1.6709e-01,
         -2.0087e-01, -1.0546e+00,  1.1026e+00, -2.0277e-01, -1.1109e+00,
          3.4603e-01, -3.5958e-01, -9.3172e-01, -3.0376e-01, -1.5463e-01,
         -1.3432e+00,  9.1135e-02,  1.1439e+00, -1.5339e+00, -4.6045e-01,
         -5.5025e-01,  4.0596e-01, -3.9708e-01, -6.4834e-02, -5.2232e-01,
          6.5589e-01, -8.8874e-01,  1.5596e+00,  1.5577e-01, -3.5365e-01,
          6.3513e-01, -2.7311e-02, -8.1978e-01, -4.9399e-01, -5.3811e-01,
          1.0566e+00,  2.8967e-01,  6.2146e-01,  1.0993e+00, -3.0212e-01,
         -2.1883e-01,  5.7937e-01,  6.1942e-01,  2.4679e-02,  8.2628e-01,
          4.6581e-01, -3.6579e-01, -6.9216e-01,  6.8416e-01, -7.3741e-01,
          6.2703e-01,  7.7389e-02, -1.2204e+00, -4.1666e-02,  8.7555e-01,
         -7.7057e-01,  5.0619e-01,  4.8472e-01,  3.2393e-01,  5.3940e-01,
          1.0771e+00,  1.5114e-01,  4.4238e-01,  6.3183e-02,  1.2169e+00,
         -3.9446e-02, -3.8013e-01, -6.4707e-02, -3.2169e-01, -4.9781e-01,
         -1.7613e+00,  2.5739e-01, -4.1053e-01,  6.2885e-01,  1.3770e+00,
         -5.8686e-01,  1.0323e-02,  7.5088e-01, -2.9312e-01, -1.1547e-01,
         -7.8725e-01,  8.5599e-01,  7.9803e-01,  1.1069e-01, -2.3976e-01,
         -8.4177e-01, -4.2161e-01,  5.0596e-01, -6.4548e-01,  6.4632e-01,
          7.4988e-01, -7.8123e-01,  4.8951e-01,  6.4393e-02,  4.9070e-01,
          2.1786e-01,  5.7280e-01,  3.5160e-01, -2.2284e-01, -7.9990e-01,
          2.2729e-01,  1.8816e-01,  8.8223e-01,  1.1703e-01, -6.4749e-01,
         -5.8476e-01,  2.5377e+00,  5.7148e-02, -8.7833e-01,  1.7292e+00,
          5.0826e-01, -1.9168e-01, -7.5839e-01, -1.9209e-01, -5.5647e-01,
          3.0391e-02,  5.6603e-01, -4.8961e-03, -2.5282e-01,  7.5350e-01,
         -1.1344e+00, -1.4070e-01, -8.9513e-01,  7.4961e-01, -1.1970e-01,
         -7.3336e-02, -1.1068e-01,  7.3566e-02,  5.6845e-01,  2.1489e-01,
         -6.5505e-01, -1.2820e-01, -3.3920e-01,  1.5871e+00, -5.2015e-01,
          3.3619e-01,  7.0415e-01,  3.2495e-01, -5.3305e-01, -2.2975e-01,
          1.3166e+00, -3.2679e-01,  7.5879e-01, -1.0653e-01, -4.4026e-01,
          4.1603e-01,  5.2475e-02, -1.6943e-01,  8.8995e-01, -6.2589e-01,
          3.0634e-01,  1.2930e+00,  7.2234e-02, -9.0965e-01, -1.0700e+00,
          3.4310e-01, -1.2260e+00,  1.8289e+00,  8.8422e-01, -5.6928e-01,
         -6.0448e-01, -4.8503e-01,  1.1665e+00,  2.0679e-02,  2.8453e-02,
         -6.0937e-01, -4.1578e-01,  1.9339e+00,  2.4066e-01,  1.0494e+00,
          2.7195e-01,  1.4564e+00, -9.5954e-01, -5.6960e-01, -2.9046e-02,
          8.7571e-01,  2.3768e-01,  1.6071e-02,  6.8685e-02, -1.2168e-02,
         -7.7270e-02,  1.3159e+00,  1.4786e-01, -5.2601e-01,  2.3713e-01,
         -1.1930e+00,  9.1587e-01, -6.1435e-01,  1.2316e+00,  4.2188e-01,
         -1.8967e-01,  2.2418e-01, -5.6820e-01, -1.3509e-01,  5.2932e-01,
          9.6652e-01,  4.6657e-02,  6.1744e-01, -1.9748e-01,  1.2703e-01,
          8.3173e-01, -2.5734e-02, -2.6779e-01,  4.8575e-01,  2.3362e-01,
          7.7303e-01, -1.5916e+00,  3.2863e-01, -9.4550e-01, -9.6210e-02,
          1.6319e+00,  1.7730e-01, -1.0157e-01,  4.4117e-01, -7.3891e-01,
         -4.1367e-01,  3.6194e-01, -1.3486e+00, -5.8259e-01, -1.3829e-01,
         -2.9916e-02,  5.3416e-01,  4.2438e-01, -2.3908e-01,  9.0574e-01,
         -1.8279e-01, -7.2764e-01,  4.2451e-01,  3.9693e-01, -5.3173e-01,
          3.3806e-01, -4.3441e-01, -2.7049e-01, -4.6972e-02, -6.8819e-01,
         -3.2226e-01,  4.9129e-01, -2.1682e+00, -5.5371e-02, -9.3042e-01,
          3.5398e-01, -7.6391e-01, -9.2809e-01, -8.9272e-01,  2.9996e-01,
         -5.9074e-02, -2.2773e-01, -5.0153e-01, -2.7393e-01, -5.4983e-01,
          2.7882e-01, -4.4065e-02, -8.3886e-01, -7.4027e-02, -2.6896e-01,
          8.5361e-03,  3.3698e-01, -8.6718e-01,  5.1307e-01, -2.1603e-01,
          1.3868e+00,  1.7414e-01, -1.7457e-01,  1.3037e-01, -2.4141e-01,
         -7.4227e-04, -7.3885e-01, -5.3176e-01, -4.5257e-01, -1.0625e+00,
          1.2156e+00, -5.2185e-01,  2.8808e-01,  8.7007e-01,  8.5056e-01,
          7.6806e-02,  1.0252e+00,  2.0061e-01,  2.4850e-01,  3.0392e-01,
         -6.6412e-02, -6.5955e-01,  6.4762e-01, -9.9459e-01, -6.8125e-02,
          4.0887e-01,  5.3319e-01,  1.6282e+00, -1.2068e+00,  2.2869e-01,
         -1.1052e-01,  4.0362e-01, -9.3996e-02, -4.8822e-01,  5.1702e-01,
          5.8312e-01,  7.9796e-01,  6.8430e-01,  4.1496e-01, -1.2208e-01,
          5.4104e-01,  1.0194e+00, -5.7622e-02, -2.2833e-02, -6.7288e-01,
         -1.1260e+00,  9.8069e-02, -1.0257e+00,  9.2919e-01, -1.0237e-01,
         -1.5401e+00, -2.8941e-01, -9.2963e-01, -1.4487e+00,  1.0130e+00,
         -5.6231e-01, -3.3378e-01, -1.3348e+00, -1.1676e+00, -2.5416e-01,
         -1.0803e-01,  2.0760e-01,  5.6882e-01, -1.2887e+00,  1.4549e-01,
          2.0258e-01,  1.7028e-01, -8.5898e-01,  5.2978e-01,  4.4359e-01,
         -5.7517e-01, -7.8174e-02,  6.1613e-01,  7.4607e-01, -1.7683e+00,
          7.6454e-01,  4.9914e-01, -1.4074e+00,  6.2253e-02,  2.5565e-01,
          4.3341e-01, -4.6436e-01,  1.1203e-01, -1.9920e-01, -3.4213e-01,
          1.1423e+00,  6.1253e-01,  1.9527e-01,  4.0889e-01,  2.5531e-01,
          5.1939e-01, -7.7469e-01, -8.1979e-01,  1.7956e-01, -8.9522e-01,
          6.8632e-01, -1.0461e+00, -3.9999e-01,  1.0326e+00, -1.5468e+00,
         -5.8352e-01,  3.3918e-01,  1.8445e-01, -9.5773e-02,  5.6534e-01,
         -8.7374e-01, -6.8467e-01,  4.2375e-01, -9.1203e-01,  1.3502e-01,
         -3.7027e-01, -1.0982e-02,  7.5740e-01, -7.3095e-01, -3.0599e-01,
          6.3648e-01,  3.1394e-02, -4.4516e-01,  4.4641e-01,  7.5885e-01,
          1.7890e-01,  1.3229e+00, -1.0592e+00, -2.9969e-01, -3.0708e-01,
         -3.7039e-01,  1.7160e-01,  3.2778e-01, -1.0215e-01,  5.0190e-01,
         -1.8176e-02, -1.6133e+00,  3.0980e-01, -1.0157e+00,  1.1281e+00,
         -6.1154e-01, -7.2161e-01, -4.4620e-01, -6.6299e-01, -1.0826e+00,
         -1.7627e-02, -6.7078e-02,  8.6347e-02,  4.6239e-01,  1.4051e+00,
         -8.7356e-01,  3.3305e-01,  6.9102e-01, -2.7159e-01, -5.5041e-01,
          1.2204e+00, -8.5500e-02,  4.3142e-01,  1.4226e+00, -1.3989e+00,
         -4.7674e-02, -2.2110e-01,  2.9688e-01,  2.4376e-01, -2.6609e-01,
         -1.3538e-02, -2.3656e-02,  1.1809e-01, -1.1414e-01,  2.8658e-01,
         -3.8777e-01,  7.1307e-01,  9.1114e-01,  3.8183e-01, -5.3103e-01,
          9.5604e-01,  6.4291e-01, -1.0537e+00,  3.5009e-01, -5.8949e-01,
         -5.2560e-01,  1.7815e+00,  1.7474e-01, -2.0713e-01, -2.3950e-01,
         -3.7320e-01,  4.2646e-01, -1.3481e-01,  3.0155e-01, -8.0324e-01,
         -2.8006e-01, -1.9803e-01, -5.0213e-01, -1.3103e+00, -7.5506e-01,
         -6.1868e-02, -1.3231e+00, -8.7083e-02, -3.1547e-01,  7.3627e-01,
          7.2386e-01, -1.1125e+00,  1.2735e-01,  4.0717e-01,  3.3035e-01,
         -1.0369e+00, -1.4225e-01,  3.3954e-01,  2.4253e-01,  7.2242e-01,
          8.0458e-01, -6.1499e-01,  9.8543e-01, -8.7299e-01, -1.6614e-01,
         -2.6165e-01,  6.9127e-01, -1.0669e+00,  9.4245e-01,  6.0928e-01]
            fingerprints.append(finger)
        if finger is not None:
            fingerprints.append(finger)
        else:
            print(f"Unrecognized psmiles: {psmiles}") 
    
    for polysmiles in poly_smiles:
        p_atomfeatures,p_adj=smile_to_graph(polysmiles)
        
        pgraph.append(p_atomfeatures)
        p_adjs.append(p_adj)


        
    i=1    
    for smiles in compound_smiles:
        atom_features,adj=smile_to_graph(smiles)
        graph.append(atom_features)
        adjacencies.append(adj)


        mol = Chem.MolFromSmiles(smiles)
        fp = AllChem.GetMorganFingerprintAsBitVect(mol,2,2048)
        npfp = np.array(list(fp.ToBitString())).astype('int8')
        morgan.append(npfp)

        i+=1
        print(i)

        


    dir_input = fileinput
    os.makedirs(dir_input, exist_ok=True)
    
    np.save(dir_input + 'fingerprints', np.array(fingerprints, dtype=object))
    np.save(dir_input + 'pgraph', np.array(pgraph, dtype=object))
    np.save(dir_input + 'padjs', np.array(p_adjs, dtype=object))
    np.save(dir_input + 'morgan', np.array(morgan, dtype=object))
    np.save(dir_input + 'graph', np.array(graph, dtype=object))
    np.save(dir_input + 'adjacencies', np.array(adjacencies, dtype=object))
    np.save(dir_input + 'label', np.array(label))
    np.save(dir_input + 'size', np.array(size))
    np.save(dir_input + 'water', np.array(water))


if __name__ == "__main__":

    import os
    word_dict = defaultdict(lambda: len(word_dict))
    inputfile('test_predata.txt','test_predata/')
